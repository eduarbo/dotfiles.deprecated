<% numbers_row = "1234567890".split(""); %>
<% symbols_modifier = "left_shift"; %>
{
    "title": "Personal rules (@eduarbo)",
    "rules": [
        {
            "description": "Better modifiers to reach them all with the thumbs",
            "manipulators": [
                {
                    "description": "Change spacebar to left_command. (Post escape if pressed alone)",
                    "type": "basic",
                    "from": <%= from("spacebar", [], ["any"]) %>,
                    "to": <%= to([["left_command"]]) %>,
                    "to_if_alone": <%= to([["escape"]]) %>
                },
                {
                    "description": "Change right_command to right_shift. (Post return_or_enter if pressed alone)",
                    "type": "basic",
                    "from": <%= from("right_command", [], ["any"]) %>,
                    "to": <%= to([["right_shift"]]) %>,
                    "to_if_alone": <%= to([["return_or_enter"]]) %>
                },
                {
                    "description": "Change left_command to left_shift. (Post spacebar if pressed alone)",
                    "type": "basic",
                    "from": <%= from("left_command", [], ["any"]) %>,
                    "to": <%= to([["left_shift"]]) %>,
                    "to_if_alone": <%= to([["spacebar"]]) %>
                },
                {
                    "description": "Change right_option to right_option. (Post right_parenthesis if pressed alone)",
                    "type": "basic",
                    "from": <%= from("right_option", [], ["any"]) %>,
                    "to": <%= to([["right_option"]]) %>,
                    "to_if_alone": <%= to([["0", ["right_shift"]]]) %>
                },
                {
                    "description": "Change left_option to left_control. (Post left_parenthesis if pressed alone)",
                    "type": "basic",
                    "from": <%= from("left_option", [], ["any"]) %>,
                    "to": <%= to([["left_control"]]) %>,
                    "to_if_alone": <%= to([["9", ["right_shift"]]]) %>
                },
                {
                    "description": "Change left_control to fn.",
                    "type": "basic",
                    "from": <%= from("left_control", [], ["any"]) %>,
                    "to": <%= to([["fn"]]) %>
                }
            ]
        },
        {
            "description": "Symbols Layer",
            "manipulators": [
                <% "qwertyuiop".split("").each_with_index do |char, index| %>
                {
                    "type": "basic",
                    "from": <%= from(char, [symbols_modifier], []) %>,
                    "to": <%= to([[numbers_row[index]]]) %>
                },
                <% end %>

                <% "asdfghjk".split("").each_with_index do |char, index| %>
                {
                    "type": "basic",
                    "from": <%= from(char, [symbols_modifier], []) %>,
                    "to": <%= to([[numbers_row[index], ["right_shift"]]]) %>
                },
                <% end %>
                {
                    "type": "basic",
                    "from": <%= from("l", [symbols_modifier], []) %>,
                    "to": <%= to([["backslash"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("semicolon", [symbols_modifier], []) %>,
                    "to": <%= to([["backslash", ["right_shift"]]]) %>
                },

                {
                    "type": "basic",
                    "from": <%= from("z", [symbols_modifier], []) %>,
                    "to": <%= to([["1", ["right_option"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("x", [symbols_modifier], []) %>,
                    "to": <%= to([["equal_sign"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("c", [symbols_modifier], []) %>,
                    "to": <%= to([["hyphen"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("v", [symbols_modifier], []) %>,
                    "to": <%= to([["equal_sign", ["right_shift"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("b", [symbols_modifier], []) %>,
                    "to": <%= to([["hyphen", ["right_shift"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("n", [symbols_modifier], []) %>,
                    "to": <%= to([["n", ["right_option"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("m", [symbols_modifier], []) %>,
                    "to": <%= to([["e", ["right_option"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("slash", [symbols_modifier], []) %>,
                    "to": <%= to([["slash", ["right_shift", "right_option"]]]) %>
                }
            ]
        },
        {
            "description": "Vi Mode [D as Trigger Key]",
            "manipulators": [

                <%# -------------------------------------------------- %>
                <%# press d to enter Vi Mode, release to quit %>
                <%# -------------------------------------------------- %>
                {
                    "type": "basic",
                    "from": <%= from("d", [], ["any"]) %>,
                    "to": [
                        { "set_variable": { "name": "vi_mode", "value": 1 } }
                    ],
                    "to_if_alone": <%= to([["d"]]) %>,
                    "to_after_key_up": [
                        { "set_variable": { "name": "vi_mode", "value": 0 } }
                    ]
                },

                <%# -------------------------------------------------- %>
                <%# change h/j/k/l to arrow keys %>
                <%# -------------------------------------------------- %>
                {
                    "type": "basic",
                    "from": <%= from("h", [], ["any"]) %>,
                    "to": <%= to([["left_arrow"]]) %>,
                    "conditions": [
                        { "type": "variable_if", "name": "vi_mode", "value": 1 },
                        { "type": "variable_if", "name": "vi_visual_mode", "value": 0 }
                    ]
                },
                {
                    "type": "basic",
                    "from": <%= from("j", [], ["any"]) %>,
                    "to": <%= to([["down_arrow"]]) %>,
                    "conditions": [
                        { "type": "variable_if", "name": "vi_mode", "value": 1 },
                        { "type": "variable_if", "name": "vi_visual_mode", "value": 0 }
                    ]
                },
                {
                    "type": "basic",
                    "from": <%= from("k", [], ["any"]) %>,
                    "to": <%= to([["up_arrow"]]) %>,
                    "conditions": [
                        { "type": "variable_if", "name": "vi_mode", "value": 1 },
                        { "type": "variable_if", "name": "vi_visual_mode", "value": 0 }
                    ]
                },
                {
                    "type": "basic",
                    "from": <%= from("l", [], ["any"]) %>,
                    "to": <%= to([["right_arrow"]]) %>,
                    "conditions": [
                        { "type": "variable_if", "name": "vi_mode", "value": 1 },
                        { "type": "variable_if", "name": "vi_visual_mode", "value": 0 }
                    ]
                }
            ]
        }
    ]
}
