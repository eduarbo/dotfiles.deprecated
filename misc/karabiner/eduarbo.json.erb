{
    "title": "Personal rules (@eduarbo)",
    "rules": [
        {
            "description": "Thumb cluster",
            "manipulators": [
                {
                    "description": "Change spacebar to right_command. (Post return if pressed alone)",
                    "type": "basic",
                    "from": <%= from("spacebar", [], ["any"]) %>,
                    "to": <%= to([["right_command"]]) %>,
                    "to_if_alone": <%= to([["return_or_enter"]]) %>
                },
                {
                    "description": "Change right_command to right_shift. (Post escape if pressed alone)",
                    "type": "basic",
                    "from": <%= from("right_command", [], ["any"]) %>,
                    "to": <%= to([["right_shift"]]) %>,
                    "to_if_alone": <%= to([["escape"]]) %>
                },
                {
                    "description": "Change left_command to left_shift. (Post spacebar if pressed alone)",
                    "type": "basic",
                    "from": <%= from("left_command", [], ["any"]) %>,
                    "to": <%= to([["left_shift"]]) %>,
                    "to_if_alone": <%= to([["spacebar"]]) %>
                },
                {
                    "description": "Change right_option to right_option. (Post open parenthesis if pressed alone)",
                    "type": "basic",
                    "from": <%= from("right_option", [], ["any"]) %>,
                    "to": <%= to([["right_option"]]) %>,
                    "to_if_alone": <%= to([["0", ["left_shift"]]]) %>
                },
                {
                    "description": "Change left_option to right_control. (Post close parenthesis if pressed alone)",
                    "type": "basic",
                    "from": <%= from("left_option", [], ["any"]) %>,
                    "to": <%= to([["right_control"]]) %>,
                    "to_if_alone": <%= to([["9", ["left_shift"]]]) %>
                },
                {
                    "description": "Change left_control to fn",
                    "type": "basic",
                    "from": <%= from("left_control", [], ["any"]) %>,
                    "to": <%= to([["fn"]]) %>
                }
            ]
        },
        {
            "description": "Moving Around",
            "manipulators": [
                {
                    "type": "basic",
                    "from": <%= from("h", ["right_option"], ["any"]) %>,
                    "to": <%= to([["left_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("j", ["right_option"], ["any"]) %>,
                    "to": <%= to([["down_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("k", ["right_option"], ["any"]) %>,
                    "to": <%= to([["up_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("l", ["right_option"], ["any"]) %>,
                    "to": <%= to([["right_arrow"]]) %>
                }
            ]
        },
        {
            "description": "Emacs key bindings",
            "manipulators": [
                {
                    "description": "Change control+u to delete-to-beginning-of-line",
                    "type": "basic",
                    "from": <%= from("u", ["control"], ["caps_lock"]) %>,
                    "to": <%= to([["a", ["control", "left_shift"]], ["delete_or_backspace"], ["vk_none"]]) %>,
                    "conditions": [ <%= frontmost_application_unless("emacs_key_bindings_exception") %> ]
                },
                {
                    "description": "Change control+w to option+delete",
                    "type": "basic",
                    "from": <%= from("w", ["control"], ["caps_lock"]) %>,
                    "to": <%= to([["delete_or_backspace", ["option"]]]) %>,
                    "conditions": [ <%= frontmost_application_unless("emacs_key_bindings_exception") %> ]
                },
                {
                    "type": "basic",
                    "from": <%= from("d", ["control"], ["caps_lock"]) %>,
                    "to": <%= to([["delete_forward"]]) %>,
                    "conditions": [ <%= frontmost_application_unless("emacs_key_bindings_exception") %> ]
                },
                {
                    "type": "basic",
                    "from": <%= from("b", ["control"], ["caps_lock", "shift"]) %>,
                    "to": <%= to([["left_arrow", ["option"]]]) %>,
                    "conditions": [ <%= frontmost_application_unless("emacs_key_bindings_exception") %> ]
                },
                {
                    "type": "basic",
                    "from": <%= from("f", ["control"], ["caps_lock", "shift"]) %>,
                    "to": <%= to([["right_arrow", ["option"]]]) %>,
                    "conditions": [ <%= frontmost_application_unless("emacs_key_bindings_exception") %> ]
                }
            ]
        },
        {
            <%
                symbols_modifier = "left_shift";
                numbers_row = "1234567890".split("");
                optional_modifiers = ["caps_lock", "command", "control", "option"];
            %>
            "description": "Symbols Layer",
            "manipulators": [
                <% "qwertyui".split("").each_with_index do |char, index| %>
                {
                    "type": "basic",
                    "from": <%= from(char, [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([[numbers_row[index], ["left_shift"]]]) %>
                },
                <% end %>

                <% "asdfghjkl".split("").each_with_index do |char, index| %>
                {
                    "type": "basic",
                    "from": <%= from(char, [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([[numbers_row[index]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("semicolon", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["0"]]) %>
                },
                <% end %>
                {
                    "type": "basic",
                    "from": <%= from("o", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["backslash"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("p", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["backslash", ["left_shift"]]]) %>
                },

                {
                    "type": "basic",
                    "from": <%= from("z", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["1", ["left_option"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("x", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["grave_accent_and_tilde", ["left_shift"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("c", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["hyphen", "left_shift"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("v", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["equal_sign"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("b", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["grave_accent_and_tilde"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("n", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["n", ["left_option"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("m", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["e", ["left_option"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("comma", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["hyphen"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("period", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["equal_sign", ["left_shift"]]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("slash", [symbols_modifier], optional_modifiers) %>,
                    "to": <%= to([["slash", ["left_shift", "left_option"]]]) %>
                }
            ]
        },
        {
            "description": "Main layer",
            "manipulators": [
                {
                    "type": "basic",
                    "from": <%= from("caps_lock", [], ["any"]) %>,
                    "to": <%= to([["delete_or_backspace"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("delete_or_backspace", [], ["any"]) %>,
                    "to": <%= to([["f13"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("open_bracket", [], ["any"]) %>,
                    "to": <%= to([["grave_accent_and_tilde"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("left_shift", [], ["any"]) %>,
                    "to": <%= to([["open_bracket"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("right_shift", [], ["any"]) %>,
                    "to": <%= to([["close_bracket"]]) %>
                }
            ]
        },
        {
            "description": "Fn Layer",
            "manipulators": [
                <%# -------------------------------------------------- %>
                <%# Volume controls %>
                <%# -------------------------------------------------- %>
                {
                    "type": "basic",
                    "from": <%= from("q", ["fn"], []) %>,
                    "to": <%= to([["volume_decrement"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("t", ["fn"], []) %>,
                    "to": <%= to([["volume_increment"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("tab", ["fn"], []) %>,
                    "to": <%= to([["mute"]]) %>
                },

                <%# -------------------------------------------------- %>
                <%# Brightness controls %>
                <%# -------------------------------------------------- %>
                {
                    "type": "basic",
                    "from": <%= from("w", ["fn"], []) %>,
                    "to": <%= to([["display_brightness_decrement"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("r", ["fn"], []) %>,
                    "to": <%= to([["display_brightness_increment"]]) %>
                },

                <%# -------------------------------------------------- %>
                <%# Movement %>
                <%# -------------------------------------------------- %>
                {
                    "type": "basic",
                    "from": <%= from("a", ["fn"], []) %>,
                    "to": <%= to([["home"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("g", ["fn"], []) %>,
                    "to": <%= to([["end"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("e", ["fn"], []) %>,
                    "to": <%= to([["up_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("s", ["fn"], []) %>,
                    "to": <%= to([["left_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("d", ["fn"], []) %>,
                    "to": <%= to([["down_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("f", ["fn"], []) %>,
                    "to": <%= to([["right_arrow"]]) %>
                },

                <%# -------------------------------------------------- %>
                <%# Function keys %>
                <%# -------------------------------------------------- %>
                <%
                    remap_function_keys = [
                        'y', 'u', 'i', 'o',
                        'h', 'j', 'k', 'l',
                        'n', 'm', 'comma', 'period'
                    ];
                %>

                <% remap_function_keys.each.with_index(1) do |char, index| %>
                {
                    "type": "basic",
                    "from": <%= from(char, ["fn"], []) %>,
                    "to": <%= to([["f#{index}", ["fn"]]]) %>
                },
                <% end %>

                <%# -------------------------------------------------- %>
                <%# Music %>
                <%# -------------------------------------------------- %>
                {
                    "type": "basic",
                    "from": <%= from("x", ["fn"], []) %>,
                    "to": <%= to([["rewind"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("c", ["fn"], []) %>,
                    "to": <%= to([["play_or_pause"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("v", ["fn"], []) %>,
                    "to": <%= to([["fastforward"]]) %>
                }
            ]
        },
        {
            <%
                appsMap = {
                    "a" => "/Applications/Calendar.app",
                    "b" => "/Applications/Karabiner-Elements.app",
                    "d" => "/Applications/1Password 6.app",
                    "e" => "/Applications/Emacs.app",
                    "f" => "/System/Library/CoreServices/Finder.app",
                    "g" => "/Applications/Google Chrome.app",
                    "i" => "/Applications/iTerm.app",
                    "m" => "/Applications/Mail.app",
                    "n" => "/Applications/Notes.app",
                    "o" => "/Applications/Opera.app",
                    "p" => "/Applications/Spotify.app",
                    "r" => "/Applications/Utilities/Activity Monitor.app",
                    "s" => "/Applications/Slack.app",
                    "q" => "/System/Library/Frameworks/ScreenSaver.framework/Versions/A/Resources/ScreenSaverEngine.app"
                }
            %>

            "description": "Launch apps by right option+letters.",
            "manipulators": [
                <% appsMap.each do |key, appPath| %>
                {
                    "type": "basic",
                    "from": <%= from(key, ["right_option"], ["caps_lock"]) %>,
                    "to": [{ "shell_command": "open '<%= appPath %>'" }]
                },
                <% end %>
                { "type": "basic" }
            ]
        }
    ]
}
